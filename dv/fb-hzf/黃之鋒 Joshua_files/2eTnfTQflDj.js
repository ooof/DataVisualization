/*!CK:735122556!*//*1415719905,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["Qpb4e"]); }

__d("cloneWithProps",["ReactElement","ReactPropTransferer","keyOf","warning"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k=i({children:null});function l(m,n){var o=h.mergeProps(n,m.props);if(!o.hasOwnProperty(k)&&m.props.hasOwnProperty(k))o.children=m.props.children;return g.createElement(m.type,o);}e.exports=l;},null);
__d("MTouchableArea.react",["MJSEnvironment","React","cloneWithProps","cx","onlyChild"],function(a,b,c,d,e,f,g,h,i,j,k){var l=g.IS_ANDROID&&g.OS_VERSION<4.1,m=3,n=h.createClass({displayName:"MTouchableArea",propTypes:{onTouchEnd:h.PropTypes.func,onTouchMove:h.PropTypes.func,onTouchStart:h.PropTypes.func},getInitialState:function(){return {touchStartX:0,touchStartY:0,isTouched:false};},handleTouchEnd:function(event){this.setState(this.getInitialState());if(this.props.onTouchEnd)this.props.onTouchEnd(event);},handleTouchMove:function(event){var o=event.nativeEvent.touches[0].screenX-this.state.touchStartX,p=event.nativeEvent.touches[0].screenY-this.state.touchStartY;if(o>m||p>m)this.setState(this.getInitialState());if(this.props.onTouchMove)this.props.onTouchMove(event);},handleTouchStart:function(event){if(l){this.setState({isTouched:true,touchStartX:event.nativeEvent.touches[0].screenX,touchStartY:event.nativeEvent.touches[0].screenY});}else this.setState({isTouched:true});if(this.props.onTouchStart)this.props.onTouchStart(event);},render:function(){return i(k(this.props.children),{className:((this.state.isTouched?"touched":'')),onTouchEnd:this.handleTouchEnd,onTouchMove:l?this.handleTouchMove:this.props.onTouchMove,onTouchStart:this.handleTouchStart});}});e.exports=n;},null);
__d("MTaggableActivityPreviewTemplate",["invariant"],function(a,b,c,d,e,f,g){function h(i,j){"use strict";this.$MTaggableActivityPreviewTemplate0=i;this.$MTaggableActivityPreviewTemplate1=j;}h.prototype.getTemplateArray=function(){"use strict";var i=0,j=this.$MTaggableActivityPreviewTemplate1.length,k,l=[];for(var m=0;m<=this.$MTaggableActivityPreviewTemplate1.length;m++){k=m!==j?this.$MTaggableActivityPreviewTemplate1[m].position:this.$MTaggableActivityPreviewTemplate0.length;l.push(this.$MTaggableActivityPreviewTemplate0.slice(i,k));i=k;}return l;};h.prototype.getTokens=function(){"use strict";return this.$MTaggableActivityPreviewTemplate1;};h.prototype.renderArray=function(i){"use strict";g(this.$MTaggableActivityPreviewTemplate1.length===i.length);var j=this.getTemplateArray().concat();for(var k=i.length;k>0;k--)j.splice(k,0,i[k-1]);return j;};e.exports=h;},null);
__d("MTaggableActivityPreviewTemplateQuery",["MTaggableActivityPreviewTemplateConstants","Deferred","ErrorUtils","MCache","MTaggableActivityPreviewTemplate","MRequest","XTaggableActivityPreviewTemplateQueryControllerURIBuilder","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=g.TOKEN_TYPES,p=1209600000,q='__created_at';function r(t){return i.applyWithGuard(t,null,null,null,'MTaggableActivityPreviewTemplate');}function s(t){"use strict";this.$MTaggableActivityPreviewTemplateQuery0=t;this.$MTaggableActivityPreviewTemplateQuery1={has_place_type:'',has_users_type:''};}s.prototype.$MTaggableActivityPreviewTemplateQuery2=function(t){"use strict";t[q]=Date.now();r(function(){return j.setItem(this.getCacheKey(),t);}.bind(this));return this.$MTaggableActivityPreviewTemplateQuery3(t);};s.prototype.$MTaggableActivityPreviewTemplateQuery3=function(t){"use strict";var u=t[this.$MTaggableActivityPreviewTemplateQuery4()];n(u);return new k(u.string,u.tokens);};s.prototype.getCacheKey=function(){"use strict";return [g.CACHE_PREFIX,g.VERSION,this.$MTaggableActivityPreviewTemplateQuery0,g.LOCALE,g.GENDER].join('_');};s.prototype.$MTaggableActivityPreviewTemplateQuery5=function(){"use strict";var t=this.getCacheKey(),u=r(function(){return j.getItem(t);});if(!u)return null;if((Date.now()-u[q])>p){r(function(){return j.removeItem(t);});return null;}return this.$MTaggableActivityPreviewTemplateQuery3(u);};s.prototype.$MTaggableActivityPreviewTemplateQuery4=function(){"use strict";return g.KEY_PREFIX+'_'+Object.keys(this.$MTaggableActivityPreviewTemplateQuery1).sort().map(function(t){return this.$MTaggableActivityPreviewTemplateQuery1[t];}.bind(this)).join('_');};s.prototype.getURI=function(){"use strict";return new m().setInt('action_type_id',this.$MTaggableActivityPreviewTemplateQuery0).getURI();};s.prototype.fetch=function(){"use strict";var t=new h(),u=this.$MTaggableActivityPreviewTemplateQuery5();return u?t.succeed(u):this.$MTaggableActivityPreviewTemplateQuery6(t);};s.prototype.$MTaggableActivityPreviewTemplateQuery6=function(t){"use strict";var u=new l(this.getURI()).setMethod('GET');u.listen('done',function(v){t.succeed(this.$MTaggableActivityPreviewTemplateQuery2(v.payload.templates));}.bind(this));u.send();return t;};s.prototype.setHasPeople=function(){"use strict";this.$MTaggableActivityPreviewTemplateQuery1.has_users_type=o.PEOPLE.MULTIPLE;return this;};s.prototype.setHasPerson=function(){"use strict";this.$MTaggableActivityPreviewTemplateQuery1.has_users_type=o.PEOPLE.SINGLE;return this;};s.prototype.setHasPlace=function(){"use strict";this.$MTaggableActivityPreviewTemplateQuery1.has_place_type=o.PLACE.SPECIFIC;return this;};e.exports=s;},null);
__d("MTokenizerParagraphRoot.react",["React","cx"],function(a,b,c,d,e,f,g,h){var i=g.createClass({displayName:"MTokenizerParagraphRoot",propTypes:{showSpace:g.PropTypes.bool},getDefaultProps:function(){return {showSpace:true};},render:function(){return (g.createElement("div",{className:"_5hd3"},"â€”",this.props.showSpace?' ':'',this.props.children));}});e.exports=i;},null);
__d("MTokenizerParagraphToken.react",["MTouchableArea.react","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j){var k={use:{token:"mToken _4tk2",noborder:"mToken _4tk2 _3a7k"}},l=h.createClass({displayName:"MTokenizerParagraphToken",propTypes:{use:h.PropTypes.oneOf(['token','noborder'])},getClassListForAttribute:function(m){return k[m][this.props[m]];},getDefaultProps:function(){return {use:'token'};},render:function(){return (h.createElement(g,null,h.createElement("span",h.__spread({},this.props,{className:j(this.props.className,this.getClassListForAttribute('use'))}),h.createElement("span",{className:"_4tk0"},this.props.children))));}});e.exports=l;},null);
__d("MTokenizerParagraphAtPlace.react",["MTokenizerParagraphRoot.react","MTokenizerParagraphToken.react","React","fbt","MUnifiedTaggerConstants"],function(a,b,c,d,e,f,g,h,i,j){var k=b('MUnifiedTaggerConstants').TOKEN_TYPES,l=i.PropTypes,m=i.createClass({displayName:"MTokenizerParagraphAtPlace",propTypes:{onTokenClick:l.func.isRequired,place:l.object.isRequired},render:function(){return this.props.place.isNonSpecific?this.renderNonSpecificPlace():this.renderSpecificPlace();},renderNonSpecificPlace:function(){return (i.createElement(g,null,j._("{city-name}",[j.param("city-name",this.renderPlaceToken())])));},renderPlaceToken:function(){return (i.createElement(h,{onClick:this.props.onTokenClick.bind(null,k.PLACE)},this.props.place.name));},renderSpecificPlace:function(){return (i.createElement(g,null,j._("\u5728{place-name}",[j.param("place-name",this.renderPlaceToken())])));}});e.exports=m;},null);
__d("MTokenizerParagraphIcon.react",["MTokenizerParagraphToken.react","React","Image.react","cx"],function(a,b,c,d,e,f,g,h,i,j){var k=h.createClass({displayName:"MTokenizerParagraphIcon",propTypes:{use:h.PropTypes.oneOf(['token','noborder'])},getDefaultProps:function(){return {use:'noborder'};},render:function(){return (h.createElement(g,h.__spread({},this.props),h.createElement(i,{className:"_2r5v",src:this.props.src})));}});e.exports=k;},null);
__d("intlList",["React","fbt","invariant","keyMirror"],function(a,b,c,d,e,f,g,h,i,j){'use strict';var k=function(m,n){n=n||k.CONJUNCTIONS.AND;var o=m.length;if(o===0){return '';}else if(o===1)return m[0];var p=m[o-1],q=m[0];for(var r=1;r<o-1;++r)q=h._("{previous items}\uff0c {following items}",[h.param("previous items",q),h.param("following items",m[r])]);return l(q,p,n);};function l(m,n,o){switch(o){case k.CONJUNCTIONS.AND:return (h._("{list of items}\u548c{last item}",[h.param("list of items",m),h.param("last item",n)]));case k.CONJUNCTIONS.OR:return (h._("{list of items}\u6216{last item}",[h.param("list of items",m),h.param("last item",n)]));case k.CONJUNCTIONS.NONE:return (h._("{list of items}, {last item}",[h.param("list of items",m),h.param("last item",n)]));default:i(false);}}k.CONJUNCTIONS=j({AND:null,NONE:null,OR:null});e.exports=k;},null);
__d("MTokenizerParagraphTokenList.react",["MTokenizerParagraphToken.react","React","fbt","intlList","invariant"],function(a,b,c,d,e,f,g,h,i,j,k){var l=h.createClass({displayName:"MTokenizerParagraphTokenList",propTypes:{onClick:h.PropTypes.func,names:function(m,n,o){var p=Array.isArray(m[n]);k(p&&m[n].length>1);}},render:function(){var m=this.props.names.length,n=m===2?this.props.names[1]:i._("\u5176\u4ed6{count}\u4eba",[i.param("count",m-1)]),o=[h.createElement(g,null,this.props.names[0]),h.createElement(g,null,n)];return (h.createElement("span",{onClick:this.props.onClick},j(o,j.CONJUNCTIONS.AND)));}});e.exports=l;},null);
__d("MTokenizerParagraphWithOGActivity.react",["MTaggableActivityPreviewTemplateQuery","MTokenizerParagraphIcon.react","MTokenizerParagraphTokenList.react","MTokenizerParagraphRoot.react","MTokenizerParagraphToken.react","React","cx","ix","MUnifiedTaggerConstants"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=b('MUnifiedTaggerConstants').TOKEN_TYPES,p=l.PropTypes,q=l.createClass({displayName:"MTokenizerParagraphWithOGActivity",getInitialState:function(){return {template:null};},propTypes:{ogactivity:p.object.isRequired,onTokenClick:p.func.isRequired,people:p.array,place:p.object},componentDidMount:function(){this.startTemplateQuery(this.props);},componentWillReceiveProps:function(r){this.setState({template:null});this.startTemplateQuery(r);},getTemplateQuery:function(r){var s=new g(r.ogactivity.id);if(r.people.length===1){s.setHasPerson();}else if(r.people.length>1)s.setHasPeople();if(r.place)s.setHasPlace();return s;},shouldRenderLoader:function(){return !(this.state.template&&this.props.ogactivity.icon);},startTemplateQuery:function(r){this.getTemplateQuery(r).fetch().then(function(s){this.setState({template:s});}.bind(this));},render:function(){var r=this.shouldRenderLoader()?this.renderLoading():this.renderTemplate();return (l.createElement(j,null,r));},renderLoading:function(){return (l.createElement(h,{className:"_12zh",src:n('/images/loaders/indicator_blue_small.gif')}));},renderTemplate:function(r){return this.state.template.renderArray(this.state.template.getTokens().map(this.renderToken));},renderToken:function(r){var s=r.token,t=this.props.onTokenClick.bind(null,s===o.PERSON?o.PEOPLE:s);switch(s){case o.ICON:return [l.createElement(h,{onClick:t,src:this.props.ogactivity.icon,use:"token"}),' '];case o.OBJECT:return (l.createElement(k,{onClick:t,key:s},this.props.ogactivity.object));case o.PEOPLE:return (l.createElement(i,{onClick:t,names:this.props.people.map(function(u){return u.name;}),key:s}));case o.PERSON:return (l.createElement(k,{onClick:t,key:s},this.props.people[0].name));case o.PLACE:return (l.createElement(k,{onClick:t,key:s},this.props.place.name));}}});e.exports=q;},null);
__d("MTokenizerParagraphWithMultiplePeople.react",["MTokenizerParagraphRoot.react","MTokenizerParagraphTokenList.react","React","fbt","MUnifiedTaggerConstants"],function(a,b,c,d,e,f,g,h,i,j){var k=b('MUnifiedTaggerConstants').TOKEN_TYPES,l=i.PropTypes,m=i.createClass({displayName:"MTokenizerParagraphWithMultiplePeople",propTypes:{onTokenClick:l.func.isRequired,people:l.array.isRequired},render:function(){return (i.createElement(g,null,j._("\u4e0e{list-of-people}",[j.param("list-of-people",i.createElement(h,{onClick:this.props.onTokenClick.bind(null,k.PEOPLE),names:this.props.people.map(function(n){return n.name;})}))])));}});e.exports=m;},null);
__d("MTokenizerParagraphWithMultiplePeopleAtPlace.react",["MTokenizerParagraphRoot.react","MTokenizerParagraphToken.react","MTokenizerParagraphTokenList.react","React","fbt","MUnifiedTaggerConstants"],function(a,b,c,d,e,f,g,h,i,j,k){var l=b('MUnifiedTaggerConstants').TOKEN_TYPES,m=j.PropTypes,n=j.createClass({displayName:"MTokenizerParagraphWithMultiplePeopleAtPlace",propTypes:{onTokenClick:m.func.isRequired,place:m.object.isRequired,people:m.array.isRequired},getPeopleNames:function(){return this.props.people.map(function(o){return o.name;});},render:function(){return this.props.place.isNonSpecific?this.renderNonSpecificPlace():this.renderSpecificPlace();},renderNonSpecificPlace:function(){return (j.createElement(g,null,k._("\u548c{list-of-people}\u5728{non-specific-place-name}",[k.param("list-of-people",this.renderPeopleToken()),k.param("non-specific-place-name",this.renderPlaceToken())])));},renderPeopleToken:function(){return (j.createElement(i,{onClick:this.props.onTokenClick.bind(null,l.PEOPLE),names:this.getPeopleNames()}));},renderPlaceToken:function(){return (j.createElement(h,{onClick:this.props.onTokenClick.bind(null,l.PLACE)},this.props.place.name));},renderSpecificPlace:function(){return (j.createElement(g,null,k._("\u548c{list-of-people}\u5728{place-name}",[k.param("list-of-people",this.renderPeopleToken()),k.param("place-name",this.renderPlaceToken())])));}});e.exports=n;},null);
__d("MTokenizerParagraphWithPerson.react",["MTokenizerParagraphRoot.react","MTokenizerParagraphToken.react","React","fbt","MUnifiedTaggerConstants"],function(a,b,c,d,e,f,g,h,i,j){var k=b('MUnifiedTaggerConstants').TOKEN_TYPES,l=i.PropTypes,m=i.createClass({displayName:"MTokenizerParagraphWithPerson",propTypes:{onTokenClick:l.func.isRequired,person:l.object.isRequired},render:function(){return (i.createElement(g,null,j._("\u548c{name1}\u4e00\u8d77",[j.param("name1",i.createElement(h,{onClick:this.props.onTokenClick.bind(null,k.PEOPLE)},this.props.person.name))])));}});e.exports=m;},null);
__d("MTokenizerParagraphWithPersonAtPlace.react",["MTokenizerParagraphRoot.react","MTokenizerParagraphToken.react","React","fbt","MUnifiedTaggerConstants"],function(a,b,c,d,e,f,g,h,i,j){var k=b('MUnifiedTaggerConstants').TOKEN_TYPES,l=i.PropTypes,m=i.createClass({displayName:"MTokenizerParagraphWithPersonAtPlace",propTypes:{onTokenClick:l.func.isRequired,place:l.object.isRequired,person:l.object.isRequired},render:function(){return this.props.place.isNonSpecific?this.renderNonSpecificPlace():this.renderSpecificPlace();},renderNonSpecificPlace:function(){return (i.createElement(g,null,j._("\u548c{name1}\u5728{city-name}",[j.param("name1",this.renderPersonToken()),j.param("city-name",this.renderPlaceToken())])));},renderPersonToken:function(){return (i.createElement(h,{onClick:this.props.onTokenClick.bind(null,k.PEOPLE)},this.props.person.name));},renderPlaceToken:function(){return (i.createElement(h,{onClick:this.props.onTokenClick.bind(null,k.PLACE)},this.props.place.name));},renderSpecificPlace:function(){return (i.createElement(g,null,j._("\u548c{name1}\u5728{place-name}",[j.param("name1",this.renderPersonToken()),j.param("place-name",this.renderPlaceToken())])));}});e.exports=m;},null);
__d("MTokenizerParagraph.react",["MTokenizerParagraphAtPlace.react","MTokenizerParagraphWithOGActivity.react","MTokenizerParagraphWithMultiplePeople.react","MTokenizerParagraphWithMultiplePeopleAtPlace.react","MTokenizerParagraphWithPerson.react","MTokenizerParagraphWithPersonAtPlace.react","React"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=m.PropTypes,o=m.createClass({displayName:"MTokenizerParagraph",propTypes:{ogactivity:n.object,onTokenClick:n.func,people:n.array,place:n.object},getDefaultProps:function(){return {ogactivity:null,people:[],place:null};},render:function(){return this.renderTokens();},renderTokens:function(){var p=this.props.ogactivity,q=this.props.people||[],r=this.props.place;if(p)return (m.createElement(h,m.__spread({},this.props,{ogactivity:p,people:q,place:r})));if(q.length>1&&r)return m.createElement(j,m.__spread({},this.props,{place:r,people:q}));if(q.length===1&&r)return m.createElement(l,m.__spread({},this.props,{place:r,person:q[0]}));if(r)return m.createElement(g,m.__spread({},this.props,{place:r}));if(q.length>1)return m.createElement(i,m.__spread({},this.props,{people:q}));if(q.length===1)return m.createElement(k,m.__spread({},this.props,{person:q[0]}));return m.createElement("div",m.__spread({},this.props));}});e.exports=o;},null);
__d("MStructuredComposerUnifiedTagger",["MCompositionPlaceStore","MSubscriptionsHandlerMixin","MTokenizerParagraph.react","MCompositionPlaceFields","React","Stratcom","mixin","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=m(h);for(var p in o)if(o.hasOwnProperty(p))r[p]=o[p];var q=o===null?null:o.prototype;r.prototype=Object.create(q);r.prototype.constructor=r;r.__superConstructor__=o;function r(s){"use strict";this.$MStructuredComposerUnifiedTagger0={ogActivity:null,people:null,place:null};this.$MStructuredComposerUnifiedTagger1=s;this.addSubscriptions(g.addListener('change',function(){if(g.isEmpty()){this.setAttachments({place:null});}else this.setAttachments({place:{name:g.get(j.NAME),isNonSpecific:g.get(j.IS_NON_SPECIFIC,false)}});}.bind(this)),l.listen('MComposer:tagger:update',null,function(event){return this.setAttachments(event.getData());}.bind(this)),l.listen('MComposer:tagger:update:og-icon',null,function(event){return this.setOGIcon(event.getData().icon);}.bind(this)),l.listen('MComposer:tagger:clear',null,function(){return this.clear();}.bind(this)));this.$MStructuredComposerUnifiedTagger2();}r.prototype.clear=function(){"use strict";this.$MStructuredComposerUnifiedTagger0.ogActivity=null;this.$MStructuredComposerUnifiedTagger0.people=null;this.$MStructuredComposerUnifiedTagger0.place=null;return this.$MStructuredComposerUnifiedTagger2();};r.prototype.$MStructuredComposerUnifiedTagger3=function(s){"use strict";l.invoke('MComposer:tagger:click',s);};r.prototype.$MStructuredComposerUnifiedTagger4=function(){"use strict";return this.$MStructuredComposerUnifiedTagger0.ogActivity||(this.$MStructuredComposerUnifiedTagger0.people&&this.$MStructuredComposerUnifiedTagger0.people.length)||this.$MStructuredComposerUnifiedTagger0.place;};r.prototype.$MStructuredComposerUnifiedTagger2=function(){"use strict";if(this.$MStructuredComposerUnifiedTagger4()){k.render(k.createElement(i,{ogactivity:this.$MStructuredComposerUnifiedTagger0.ogActivity,onTokenClick:function(s){return this.$MStructuredComposerUnifiedTagger3(s);}.bind(this),people:this.$MStructuredComposerUnifiedTagger0.people,place:this.$MStructuredComposerUnifiedTagger0.place}),this.$MStructuredComposerUnifiedTagger1);}else k.unmountComponentAtNode(this.$MStructuredComposerUnifiedTagger1);return this;};r.prototype.setAttachments=function(s){"use strict";n(this.$MStructuredComposerUnifiedTagger0,s);return this.$MStructuredComposerUnifiedTagger2();};r.prototype.setOGIcon=function(s){"use strict";if(this.$MStructuredComposerUnifiedTagger0.ogActivity)this.$MStructuredComposerUnifiedTagger0.ogActivity.icon=s;return this.$MStructuredComposerUnifiedTagger2();};e.exports=r;},null);